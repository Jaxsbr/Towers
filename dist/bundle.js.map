{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://towers/./src/AssetLoading/assetManager.ts","webpack://towers/./src/AssetLoading/imageAsset.ts","webpack://towers/./src/DataObjects/gameTime.ts","webpack://towers/./src/DataObjects/imageObject.ts","webpack://towers/./src/DataObjects/rectangle.ts","webpack://towers/./src/DataObjects/vector2.ts","webpack://towers/./src/Enemies/enemy.ts","webpack://towers/./src/Enemies/enemySpawner.ts","webpack://towers/./src/Levels/levelManager.ts","webpack://towers/./src/Menu/menu.ts","webpack://towers/./src/Projectiles/projectile.ts","webpack://towers/./src/Projectiles/projectileEngine.ts","webpack://towers/./src/Scenes/gameScene.ts","webpack://towers/./src/Scenes/loadScene.ts","webpack://towers/./src/Scenes/sceneManager.ts","webpack://towers/./src/Scenes/scenes.enum.ts","webpack://towers/./src/Tiles/tile.ts","webpack://towers/./src/Tiles/tileMap.ts","webpack://towers/./src/Towers/baseTower.ts","webpack://towers/./src/Towers/plainTower.ts","webpack://towers/./src/Towers/towerManager.ts","webpack://towers/./src/gameConfig.ts","webpack://towers/./src/renderEngine.ts","webpack://towers/webpack/bootstrap","webpack://towers/./src/game.ts"],"sourcesContent":["import { Level } from '../Levels/level';\r\nimport { ImageAsset } from './imageAsset';\r\n\r\nexport class AssetManager {\r\n    images: ImageAsset[] = [];\r\n\r\n    levelInfo: Level[] = [];\r\n\r\n    levelInfoLoaded: boolean;\r\n\r\n    totalAssets: number;\r\n\r\n    public loadedAssetCount: number;\r\n\r\n    public loadCompleted: boolean;\r\n\r\n    init(): void {\r\n        this.levelInfoLoaded = false;\r\n        this.loadCompleted = false;\r\n        this.totalAssets = 0;\r\n        this.initAssets();\r\n    }\r\n\r\n    initAssets(): void {\r\n        const request = new XMLHttpRequest();\r\n        request.onload = (): void => {\r\n            if (request.status === 200) {\r\n                const data = JSON.parse(request.responseText);\r\n                this.totalAssets = data.assetCount;\r\n                this.initImages(data.imageAssets);\r\n                this.initLevelInfo(data.levelInfoFile);\r\n            }\r\n        };\r\n        request.open('get', './assets/assetManifest.json', true);\r\n        request.send();\r\n    }\r\n\r\n    initImages(imageAssets: any): void {\r\n        imageAssets.forEach(asset => {\r\n            const image = new ImageAsset(asset.key, asset.src);\r\n            this.images.push(image);\r\n        });\r\n\r\n        this.images.forEach(img => {\r\n            img.init();\r\n        });\r\n    }\r\n\r\n    initLevelInfo(levelInfoFile: string): void {\r\n        if (!levelInfoFile) {\r\n            console.error('no level info file provided');\r\n            return;\r\n        }\r\n\r\n        const request = new XMLHttpRequest();\r\n\r\n        request.onload = (): void => {\r\n            if (request.status === 200) {\r\n                const data = JSON.parse(request.responseText);\r\n                this.levelInfo = data;\r\n                this.levelInfoLoaded = true;\r\n            }\r\n        };\r\n        request.open('get', levelInfoFile, true);\r\n        request.send();\r\n    }\r\n\r\n    update(): void {\r\n        this.loadedAssetCount = this.images.filter(x => x.loaded).length;\r\n        this.loadedAssetCount = this.levelInfoLoaded\r\n            ? (this.loadedAssetCount += 1)\r\n            : this.loadedAssetCount;\r\n\r\n        if (this.totalAssets !== 0 && this.totalAssets === this.loadedAssetCount) {\r\n            this.loadCompleted = true;\r\n        }\r\n    }\r\n\r\n    getImage(key: string): HTMLImageElement {\r\n        return this.images.filter(x => x.key === key).at(0).image;\r\n    }\r\n}\r\n","export class ImageAsset {\r\n    public loaded: boolean;\r\n\r\n    public image: HTMLImageElement;\r\n\r\n    public key: string;\r\n\r\n    src: string;\r\n\r\n    constructor(key: string, src: string) {\r\n        this.loaded = false;\r\n        this.key = key;\r\n        this.src = src;\r\n    }\r\n\r\n    init(): void {\r\n        this.image = new Image();\r\n        this.image.onload = (): void => {\r\n            this.loaded = true;\r\n        };\r\n        this.image.src = this.src;\r\n    }\r\n}\r\n","export class GameTime {\r\n    public delta = 0;\r\n\r\n    private previousLoopTime: number = Date.now();\r\n\r\n    public update(): void {\r\n        const currentTime = Date.now();\r\n        const delta = currentTime - this.previousLoopTime;\r\n        this.delta = delta / 1000;\r\n        this.previousLoopTime = currentTime;\r\n    }\r\n}\r\n","import { Rectangle } from './rectangle';\r\n\r\nexport class ImageObject {\r\n    public image: HTMLImageElement;\r\n\r\n    public x: number;\r\n\r\n    public y: number;\r\n\r\n    public width: number;\r\n\r\n    public height: number;\r\n\r\n    public sx: number;\r\n\r\n    public sy: number;\r\n\r\n    public swidth: number;\r\n\r\n    public sheight: number;\r\n\r\n    private sourceRect: Rectangle = null;\r\n\r\n    private destinationRect: Rectangle = null;\r\n\r\n    public get sourceRectangle(): Rectangle {\r\n        if (this.sourceRect == null) {\r\n            this.sourceRect = new Rectangle(this.sx, this.sy, this.swidth, this.sheight);\r\n        }\r\n\r\n        return this.sourceRect;\r\n    }\r\n\r\n    public get destinationRectangle(): Rectangle {\r\n        if (this.destinationRect == null) {\r\n            this.destinationRect = new Rectangle(this.x, this.y, this.width, this.height);\r\n        }\r\n\r\n        return this.destinationRect;\r\n    }\r\n}\r\n","export class Rectangle {\r\n    public left: number;\r\n\r\n    public top: number;\r\n\r\n    public bottom: number;\r\n\r\n    public right: number;\r\n\r\n    public width: number;\r\n\r\n    public height: number;\r\n\r\n    constructor(left: number, top: number, width: number, height: number) {\r\n        this.left = left;\r\n        this.top = top;\r\n        this.width = width;\r\n        this.height = height;\r\n\r\n        this.update();\r\n    }\r\n\r\n    private updateRight(): void {\r\n        this.right = this.left + this.width;\r\n    }\r\n\r\n    private updateBottom(): void {\r\n        this.bottom = this.top + this.height;\r\n    }\r\n\r\n    public update(): void {\r\n        this.updateRight();\r\n        this.updateBottom();\r\n    }\r\n\r\n    public intersectRect(rectangle: Rectangle): boolean {\r\n        return !(\r\n            rectangle.left > this.right ||\r\n            rectangle.right < this.left ||\r\n            rectangle.top > this.bottom ||\r\n            rectangle.bottom < this.top\r\n        );\r\n    }\r\n\r\n    public containsRect(rectangle: Rectangle): boolean {\r\n        return (\r\n            this.left <= rectangle.left &&\r\n            rectangle.right <= this.right &&\r\n            this.top <= rectangle.top &&\r\n            rectangle.bottom <= this.bottom\r\n        );\r\n    }\r\n\r\n    public get getCenterWidth(): number {\r\n        this.updateRight();\r\n        return this.right - this.width / 2;\r\n    }\r\n\r\n    public get getCenterHeight(): number {\r\n        this.updateBottom();\r\n        return this.bottom - this.height / 2;\r\n    }\r\n\r\n    public clone(): Rectangle {\r\n        return new Rectangle(this.left, this.top, this.width, this.height);\r\n    }\r\n\r\n    public equals(rect: Rectangle): boolean {\r\n        return (\r\n            this.left == rect.left &&\r\n            this.top == rect.top &&\r\n            this.width == rect.width &&\r\n            this.height == rect.height\r\n        );\r\n    }\r\n\r\n    public toString(): string {\r\n        return `x:${this.left} y: ${this.top} w: ${this.width} h:${this.height}`;\r\n    }\r\n}\r\n","export class Vector2 {\r\n    public x: number;\r\n\r\n    public y: number;\r\n\r\n    constructor(x = 0, y = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    public subtract(vector2: Vector2): Vector2 {\r\n        return new Vector2(this.x - vector2.x, this.y - vector2.y);\r\n    }\r\n\r\n    public distance(vector2: Vector2): number {\r\n        const x = (this.x - vector2.x) * (this.x - vector2.x);\r\n        const y = (this.y - vector2.y) * (this.y - vector2.y);\r\n        return Math.sqrt(x + y);\r\n    }\r\n\r\n    public magnitude(): number {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y);\r\n    }\r\n\r\n    public normalize(): Vector2 {\r\n        const distance = Math.sqrt(this.x * this.x + this.y * this.y);\r\n\r\n        const normalX = this.x / distance;\r\n        const normalY = this.y / distance;\r\n\r\n        return new Vector2(\r\n            Number.isNaN(normalX) ? 0 : normalX,\r\n            Number.isNaN(normalY) ? 0 : normalY\r\n        );\r\n    }\r\n\r\n    static get empty(): Vector2 {\r\n        return new Vector2(0, 0);\r\n    }\r\n}\r\n","import { Rectangle } from '../DataObjects/rectangle';\r\nimport { Vector2 } from '../DataObjects/vector2';\r\n\r\nexport class Enemy {\r\n    public position: Vector2;\r\n\r\n    public size: Vector2;\r\n\r\n    public active: boolean;\r\n\r\n    public center: Vector2;\r\n\r\n    public bounds: Rectangle;\r\n\r\n    public futurePosition: Vector2;\r\n\r\n    private enemyImage: HTMLImageElement;\r\n\r\n    private originalWayPoints: any;\r\n\r\n    private movementWayPoints: any;\r\n\r\n    private wayPointReachedThreshold = 2;\r\n\r\n    private movements: any;\r\n\r\n    private velocity: Vector2;\r\n\r\n    private direction: Vector2;\r\n\r\n    private nextMovePoint: Vector2;\r\n\r\n    private normalizedDirection: Vector2;\r\n\r\n    private distanceFromNextWaypoint: number;\r\n\r\n    private moveSpeed = 75;\r\n\r\n    private hp = 0;\r\n\r\n    private maxHp = 5;\r\n\r\n    private hpBounds: Rectangle;\r\n\r\n    private liveBounds: Rectangle;\r\n\r\n    private topPadding = 10;\r\n\r\n    private hpRemainingBarColor = 'red';\r\n\r\n    private hpFullBarColor = 'green';\r\n\r\n    private enemyName: string;\r\n\r\n    private alive = false;\r\n\r\n    constructor(enemyImage: HTMLImageElement) {\r\n        this.enemyImage = enemyImage;\r\n        this.originalWayPoints = window.tileMap.wayPoints;\r\n        this.reset(0, 0);\r\n    }\r\n\r\n    public reset(moveSpeed: number, maxHp: number): void {\r\n        this.active = false;\r\n        this.alive = false;\r\n        this.maxHp = maxHp;\r\n        this.hp = this.maxHp;\r\n        this.moveSpeed = moveSpeed;\r\n        this.movementWayPoints = this.originalWayPoints.slice();\r\n        this.movements = { left: false, right: false, up: false, down: false };\r\n        this.position = Vector2.empty;\r\n        this.futurePosition = Vector2.empty;\r\n        this.size = window.gameConfig.enemySize;\r\n        this.center = Vector2.empty;\r\n        this.velocity = Vector2.empty;\r\n        this.bounds = new Rectangle(0, 0, 0, 0);\r\n        this.nextMovePoint = null;\r\n        this.hpBounds = new Rectangle(\r\n            this.bounds.left,\r\n            this.bounds.top - this.topPadding,\r\n            this.bounds.width,\r\n            this.bounds.height\r\n        );\r\n        this.liveBounds = this.hpBounds.clone();\r\n        this.enemyName = Math.random().toString();\r\n    }\r\n\r\n    public update(delta: number): void {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n\r\n        let onLastWaypoint = false;\r\n        if (this.movementWayPoints.length <= 0) {\r\n            onLastWaypoint = true;\r\n        }\r\n\r\n        if (!this.nextMovePoint) {\r\n            const firstWayPoint = this.movementWayPoints.shift();\r\n            const waypointBounds =\r\n                window.tileMap.tileMatrix[firstWayPoint.y][firstWayPoint.x].bounds;\r\n            this.nextMovePoint = new Vector2(\r\n                waypointBounds.getCenterWidth,\r\n                waypointBounds.getCenterHeight\r\n            );\r\n        }\r\n\r\n        this.updateBounds();\r\n        this.updateHpBounds();\r\n\r\n        this.direction = this.nextMovePoint.subtract(this.center);\r\n        this.distanceFromNextWaypoint = this.direction.magnitude();\r\n\r\n        if (this.nextWaypointReached()) {\r\n            if (onLastWaypoint) {\r\n                this.nextMovePoint = null;\r\n                this.active = false;\r\n                // console.log(this.enemyName + ': end reached');\r\n                window.dispatchEvent(new CustomEvent('enemyReachedEnd'));\r\n                return;\r\n            }\r\n            const nextWayPoint = this.movementWayPoints.shift();\r\n            const waypointBounds = window.tileMap.tileMatrix[nextWayPoint.y][nextWayPoint.x].bounds;\r\n            this.nextMovePoint.x = waypointBounds.getCenterWidth;\r\n            this.nextMovePoint.y = waypointBounds.getCenterHeight;\r\n            this.direction = this.center.subtract(this.nextMovePoint);\r\n        }\r\n\r\n        this.normalizedDirection = this.direction.normalize();\r\n        if (\r\n            !Number.isNaN(this.normalizedDirection.x) &&\r\n            !Number.isNaN(this.normalizedDirection.y)\r\n        ) {\r\n            this.velocity.x = this.normalizedDirection.x * (this.moveSpeed * delta);\r\n            this.velocity.y = this.normalizedDirection.y * (this.moveSpeed * delta);\r\n            this.setMoveDirection();\r\n        }\r\n\r\n        this.applyVelocity();\r\n    }\r\n\r\n    private nextWaypointReached(): boolean {\r\n        return this.distanceFromNextWaypoint < this.wayPointReachedThreshold;\r\n    }\r\n\r\n    private updateBounds(): void {\r\n        this.bounds.left = this.position.x;\r\n        this.bounds.top = this.position.y;\r\n        this.bounds.width = this.size.x;\r\n        this.bounds.height = this.size.y;\r\n        this.bounds.update();\r\n\r\n        this.updateHpBounds();\r\n        this.updateLifeBounds();\r\n\r\n        this.center.x = this.bounds.getCenterWidth;\r\n        this.center.y = this.bounds.getCenterHeight;\r\n\r\n        this.futurePosition.x = this.center.x;\r\n        this.futurePosition.y = this.center.y;\r\n\r\n        this.futurePosition.x =\r\n            this.center.x + this.velocity.x * window.gameConfig.enemyFuturePositionModifier;\r\n        this.futurePosition.y =\r\n            this.center.y + this.velocity.y * window.gameConfig.enemyFuturePositionModifier;\r\n    }\r\n\r\n    private updateHpBounds(): void {\r\n        const percentageRemaining = (this.hp * 100) / this.maxHp;\r\n        const percentageDiff = 100 - percentageRemaining;\r\n\r\n        const percentageLive = (this.liveBounds.width * percentageDiff) / 100;\r\n        this.hpBounds.width = this.liveBounds.width - percentageLive;\r\n\r\n        this.hpBounds.left = this.bounds.left;\r\n        this.hpBounds.top = this.bounds.top;\r\n        this.hpBounds.height = this.bounds.height / this.topPadding;\r\n        this.hpBounds.update();\r\n    }\r\n\r\n    private updateLifeBounds(): void {\r\n        this.liveBounds.left = this.bounds.left;\r\n        this.liveBounds.top = this.bounds.top;\r\n        this.liveBounds.width = this.bounds.width;\r\n        this.liveBounds.height = this.bounds.height / this.topPadding;\r\n        this.liveBounds.update();\r\n    }\r\n\r\n    public draw(): void {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n\r\n        // TODO:\r\n        // Implement animation class and call draw\r\n        // Animation class to handle source rect updates.\r\n        const sourceRectangle = new Rectangle(0, 0, 68, 80);\r\n\r\n        window.renderEngine.renderImageSource(this.enemyImage, sourceRectangle, this.bounds);\r\n\r\n        // TODO:\r\n        // Introduce damage percentage bar\r\n        this.drawRemainingHPBar();\r\n        this.drawFullHPBar();\r\n    }\r\n\r\n    private drawRemainingHPBar(): void {\r\n        // debugger;\r\n        window.renderEngine.renderRect(this.liveBounds, this.hpRemainingBarColor, true);\r\n    }\r\n\r\n    private drawFullHPBar(): void {\r\n        // debugger;\r\n        window.renderEngine.renderRect(this.hpBounds, this.hpFullBarColor, true);\r\n    }\r\n\r\n    private setMoveDirection(): void {\r\n        this.movements.left = this.velocity.x < 0;\r\n        this.movements.right = this.velocity.x > 0;\r\n\r\n        this.movements.up = this.velocity.y < 0;\r\n        this.movements.down = this.velocity.y > 0;\r\n\r\n        if (\r\n            (this.movements.left || this.movements.right) &&\r\n            (this.movements.up || this.movements.down)\r\n        ) {\r\n            // We detect if both horizontal and vertical movement is set.\r\n            // As we can only play one animation per axis movement we should determine\r\n            // what axis has the greater velocity value and use that as the direction.\r\n\r\n            const horizontalValue = this.velocity.x < 0 ? this.velocity.x * -1 : this.velocity.x;\r\n\r\n            const verticalValue = this.velocity.y < 0 ? this.velocity.y * -1 : this.velocity.y;\r\n\r\n            if (horizontalValue > verticalValue) {\r\n                this.movements.left = this.velocity.x < 0;\r\n                this.movements.right = this.velocity.x > 0;\r\n                this.movements.up = false;\r\n                this.movements.down = false;\r\n            } else {\r\n                this.movements.up = this.velocity.y < 0;\r\n                this.movements.down = this.velocity.y > 0;\r\n                this.movements.left = false;\r\n                this.movements.right = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private applyVelocity(): void {\r\n        this.position.x += this.velocity.x;\r\n        this.position.y += this.velocity.y;\r\n    }\r\n\r\n    public hit(): void {\r\n        if (this.active) {\r\n            this.hp -= 1;\r\n            // console.log(this.enemyName + ': hit ' + this.hp);\r\n\r\n            if (this.hp <= 0) {\r\n                this.active = false;\r\n                // console.log(this.enemyName + ': killed');\r\n                window.dispatchEvent(new CustomEvent('enemyKilled'));\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { Enemy } from './enemy';\r\n\r\nexport class EnemySpawner {\r\n    public enemies: Enemy[] = [];\r\n\r\n    private enemyImage: HTMLImageElement;\r\n\r\n    private enemySpawnCount = 0;\r\n\r\n    private enemySpawnCountMax: number;\r\n\r\n    private enemySpawnRate: number;\r\n\r\n    private enemySpawnElapsed = 0;\r\n\r\n    private enemiesKilled = 0;\r\n\r\n    private enemiesEscaped = 0;\r\n\r\n    constructor() {\r\n        this.enemyImage = window.assetManager.getImage('squid');\r\n        this.setCurrentLevel();\r\n\r\n        window.addEventListener('enemyKilled', () => {\r\n            this.enemiesKilled += 1;\r\n        });\r\n        window.addEventListener('enemyReachedEnd', () => {\r\n            this.enemiesEscaped += 1;\r\n        });\r\n    }\r\n\r\n    public update(delta: number): void {\r\n        this.enemies.forEach(enemy => {\r\n            enemy.update(delta);\r\n        });\r\n\r\n        this.updateSpawner(delta);\r\n        this.updateRoundCheck();\r\n    }\r\n\r\n    private updateSpawner(delta: number): void {\r\n        if (this.enemySpawnCount >= this.enemySpawnCountMax) {\r\n            return;\r\n        }\r\n        this.enemySpawnElapsed += delta;\r\n        if (this.enemySpawnElapsed >= this.enemySpawnRate) {\r\n            this.enemySpawnElapsed = 0;\r\n            this.createEnemy();\r\n            this.enemySpawnCount += 1;\r\n        }\r\n    }\r\n\r\n    private updateRoundCheck(): void {\r\n        if (\r\n            this.enemiesEscaped + this.enemiesKilled ===\r\n            window.levelManager.currentLevel.enemySpawnCountMax\r\n        ) {\r\n            this.enemiesKilled = 0;\r\n            this.enemiesEscaped = 0;\r\n            this.enemySpawnCount = 0;\r\n            window.levelManager.nextLevel();\r\n            this.setCurrentLevel();\r\n        }\r\n    }\r\n\r\n    public draw(): void {\r\n        this.enemies.forEach(enemy => {\r\n            enemy.draw();\r\n        });\r\n    }\r\n\r\n    public createEnemy(): void {\r\n        // TODO:\r\n        // Reset inactive enemies from pool instead of creating new ones\r\n        // THIS IS A LEAK BTW\r\n        // console.clear();\r\n        // console.log(\"enemy in array count: \" + this.enemies.length);\r\n\r\n        const enemy = new Enemy(this.enemyImage);\r\n        enemy.reset(\r\n            window.levelManager.currentLevel.enemyMoveSpeed,\r\n            window.levelManager.currentLevel.enemyMaxHp\r\n        );\r\n        enemy.active = true;\r\n        this.enemies.push(enemy);\r\n    }\r\n\r\n    private setCurrentLevel(): void {\r\n        this.enemySpawnCountMax = window.levelManager.currentLevel.enemySpawnCountMax;\r\n        this.enemySpawnRate = window.levelManager.currentLevel.enemySpawnRate;\r\n    }\r\n}\r\n","import { Level } from './level';\r\n\r\nexport class LevelManager {\r\n    private levelInfo: Level[];\r\n\r\n    public currentLevel: Level;\r\n\r\n    constructor(levelInfo: Level[]) {\r\n        this.levelInfo = levelInfo;\r\n        this.loadLevel();\r\n    }\r\n\r\n    private loadLevel(): void {\r\n        if (this.currentLevel == null) {\r\n            this.currentLevel = this.levelInfo.at(0);\r\n        }\r\n    }\r\n\r\n    public nextLevel(): void {\r\n        const index = this.currentLevel.levelIndex + 1;\r\n        for (let l = 0; l < this.levelInfo.length; l += 1) {\r\n            if (this.levelInfo[l].levelIndex === index) {\r\n                this.currentLevel = this.levelInfo[l];\r\n                return;\r\n            }\r\n        }\r\n\r\n        // NOTE: If we get here, no more level exist\r\n        // TODO:\r\n        // Raise end of level notification\r\n        // console.log(\"last level done\")\r\n    }\r\n}\r\n","import { ImageKeyPair } from '../Types/imageKeyPair';\r\n\r\nexport class Menu {\r\n    public stagedTowerImageWidth = window.gameConfig.menuStagedTowerImageWidth;\r\n\r\n    public stagedTowerImageHeight = window.gameConfig.menuStagedTowerImageHeight;\r\n\r\n    private imageDictionary: ImageKeyPair[];\r\n\r\n    private stagedTower: string;\r\n\r\n    private menuHeight: number;\r\n\r\n    constructor() {\r\n        window.addEventListener('plainTowerClicked', () => {\r\n            this.towerClicked('plain');\r\n        });\r\n        window.addEventListener('slowTowerClicked', () => {\r\n            this.towerClicked('slow');\r\n        });\r\n        this.menuHeight = document.getElementById('tower_menu').clientHeight;\r\n\r\n        this.imageDictionary = [\r\n            { key: 'plain', image: window.assetManager.getImage('towerplain') },\r\n            { key: 'slow', image: window.assetManager.getImage('towerslow') }\r\n        ];\r\n    }\r\n\r\n    public clearStagedTower(): void {\r\n        this.stagedTower = '';\r\n    }\r\n\r\n    private towerClicked(type: string): void {\r\n        this.stagedTower = type;\r\n    }\r\n\r\n    public draw(): void {\r\n        if (!window.mouseInfo || !this.stagedTower) {\r\n            return;\r\n        }\r\n\r\n        const tX = window.mouseInfo.x - this.stagedTowerImageWidth / 2;\r\n        const tY = window.mouseInfo.y - this.stagedTowerImageHeight / 2 - this.menuHeight;\r\n\r\n        const { image } = this.imageDictionary.find(x => x.key === this.stagedTower);\r\n        window.renderEngine.renderImage(\r\n            image,\r\n            tX,\r\n            tY,\r\n            this.stagedTowerImageWidth,\r\n            this.stagedTowerImageHeight\r\n        );\r\n    }\r\n}\r\n","import { Rectangle } from '../DataObjects/rectangle';\r\nimport { Vector2 } from '../DataObjects/vector2';\r\n\r\nexport class Projectile {\r\n    public active = false;\r\n\r\n    private startPosition: Vector2;\r\n\r\n    private direction: Vector2;\r\n\r\n    private worldBounds: Rectangle;\r\n\r\n    private inWorldBounds: boolean;\r\n\r\n    public bounds: Rectangle;\r\n\r\n    private moveSpeed = 0.5;\r\n\r\n    private velocity: Vector2;\r\n\r\n    private ttl = 0;\r\n\r\n    private ttlMax = 2;\r\n\r\n    private projectileColor: string;\r\n\r\n    private projectileImage: HTMLImageElement;\r\n\r\n    private imageSourceRect: Rectangle;\r\n\r\n    constructor(projectileImage: HTMLImageElement) {\r\n        this.projectileImage = projectileImage;\r\n        this.worldBounds = window.tileMap.bounds;\r\n\r\n        this.bounds = new Rectangle(0, 0, 24, 24);\r\n        this.velocity = Vector2.empty;\r\n        this.projectileColor = 'black';\r\n        this.imageSourceRect = new Rectangle(0, 0, 32, 32);\r\n    }\r\n\r\n    public update(delta: number): void {\r\n        this.bounds.update();\r\n        this.updateTTL(delta);\r\n        this.updateVelocity(delta);\r\n    }\r\n\r\n    private updateTTL(delta: number): void {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this.ttl -= delta;\r\n        if (this.ttl <= 0) {\r\n            this.active = false;\r\n        }\r\n    }\r\n\r\n    private updateVelocity(delta: number): void {\r\n        if (!this.direction || !this.active) {\r\n            return;\r\n        }\r\n        this.velocity.x = this.direction.x * (this.moveSpeed * delta);\r\n        this.velocity.y = this.direction.y * (this.moveSpeed * delta);\r\n\r\n        this.bounds.left += this.velocity.x;\r\n        this.bounds.top += this.velocity.y;\r\n    }\r\n\r\n    public draw(): void {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n\r\n        window.renderEngine.renderImageSource(\r\n            this.projectileImage,\r\n            this.imageSourceRect,\r\n            this.bounds\r\n        );\r\n    }\r\n\r\n    public reset(startPosition: Vector2, direction: Vector2, moveSpeed: number): void {\r\n        this.active = true;\r\n        this.ttl = this.ttlMax;\r\n        this.startPosition = startPosition;\r\n        this.direction = direction;\r\n        this.moveSpeed = moveSpeed;\r\n\r\n        this.velocity.x = 0;\r\n        this.velocity.y = 0;\r\n\r\n        this.bounds.left = this.startPosition.x - this.bounds.width / 2;\r\n        this.bounds.top = this.startPosition.y - this.bounds.height / 2;\r\n        this.bounds.update();\r\n    }\r\n}\r\n","import { Vector2 } from '../DataObjects/vector2';\r\nimport { Projectile } from './projectile';\r\n\r\nexport class ProjectileEngine {\r\n    public projectiles: Projectile[] = [];\r\n\r\n    private projectileImage: HTMLImageElement;\r\n\r\n    constructor() {\r\n        this.projectileImage = window.assetManager.getImage('projectile');\r\n    }\r\n\r\n    public update(delta: number): void {\r\n        this.projectiles.forEach(projectile => {\r\n            projectile.update(delta);\r\n        });\r\n    }\r\n\r\n    public draw(): void {\r\n        this.projectiles.forEach(projectile => {\r\n            projectile.draw();\r\n        });\r\n    }\r\n\r\n    public activateProjectile(startPosition: Vector2, direction: Vector2, moveSpeed: number): void {\r\n        let poolSufficient = false;\r\n        for (let i = 0; i < this.projectiles.length; i += 1) {\r\n            if (!this.projectiles[i].active) {\r\n                this.projectiles[i].reset(startPosition, direction, moveSpeed);\r\n                poolSufficient = true;\r\n                // console.log('projectile reset');\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!poolSufficient) {\r\n            this.expandProjectilePool(startPosition, direction, moveSpeed);\r\n        }\r\n    }\r\n\r\n    private expandProjectilePool(\r\n        startPosition: Vector2,\r\n        direction: Vector2,\r\n        moveSpeed: number\r\n    ): Projectile {\r\n        const projectile = new Projectile(this.projectileImage);\r\n        this.projectiles.push(projectile);\r\n        // console.log('grow pool size: ' + this.projectiles.length);\r\n        this.activateProjectile(startPosition, direction, moveSpeed);\r\n        return projectile;\r\n    }\r\n}\r\n","import { Rectangle } from '../DataObjects/rectangle';\r\nimport { EnemySpawner } from '../Enemies/enemySpawner';\r\nimport { LevelManager } from '../Levels/levelManager';\r\nimport { Menu } from '../Menu/menu';\r\nimport { ProjectileEngine } from '../Projectiles/projectileEngine';\r\nimport { TileMap } from '../Tiles/tileMap';\r\nimport { TowerManager } from '../Towers/towerManager';\r\nimport { SceneInterface } from './scene.interface';\r\n\r\nexport class GameScene implements SceneInterface {\r\n    backgroundImage: HTMLImageElement;\r\n\r\n    tileImage: HTMLImageElement;\r\n\r\n    towerManager: TowerManager;\r\n\r\n    projectileEngine: ProjectileEngine;\r\n\r\n    menu: Menu;\r\n\r\n    // TODO: Abstract into a manager\r\n    collisionCheckElapsed = 0;\r\n\r\n    init(): void {\r\n        this.backgroundImage = window.assetManager.getImage('background');\r\n        this.tileImage = window.assetManager.getImage('tiles');\r\n        window.levelManager = new LevelManager(window.assetManager.levelInfo);\r\n        this.menu = new Menu();\r\n\r\n        window.tileMap = new TileMap(this.tileImage);\r\n        window.enemySpawner = new EnemySpawner();\r\n        this.towerManager = new TowerManager();\r\n        window.projectileEngine = new ProjectileEngine();\r\n\r\n        // TODO: Remove, towers to be added with user input\r\n        //this.towerManager.createTower(window.tileMap.tileMatrix[3][3]);\r\n        this.towerManager.createTower(window.tileMap.tileMatrix[3][5]);\r\n        //this.towerManager.createTower(window.tileMap.tileMatrix[8][7]);\r\n\r\n        window.addEventListener('mousemove', e => {\r\n            this.mouseMove(e.x, e.y);\r\n        });\r\n        window.addEventListener('mousedown', () => {\r\n            this.mouseDown();\r\n        });\r\n        window.addEventListener('mouseup', () => {\r\n            this.mouseUp();\r\n        });\r\n    }\r\n\r\n    update(): void {\r\n        const { delta } = window.gameTime;\r\n        this.checkProjectileEnemyCollision(delta);\r\n\r\n        this.towerManager.update();\r\n        window.enemySpawner.update(delta);\r\n        window.projectileEngine.update(delta);\r\n    }\r\n\r\n    // TODO: Abstract into a manager\r\n    private checkProjectileEnemyCollision(delta: number): void {\r\n        // TODO: Reduce the rate at which collision check is done\r\n        //       This saves browser performance but is less accurate,\r\n        //       missing some collisions.\r\n        this.collisionCheckElapsed += delta;\r\n        if (this.collisionCheckElapsed <= 0.001) {\r\n            return;\r\n        }\r\n        this.collisionCheckElapsed = 0;\r\n        window.enemySpawner.enemies.forEach(enemy => {\r\n            window.projectileEngine.projectiles.forEach(projectile => {\r\n                if (\r\n                    projectile.active &&\r\n                    enemy.active &&\r\n                    enemy.bounds.containsRect(projectile.bounds)\r\n                ) {\r\n                    enemy.hit();\r\n                    projectile.active = false;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    render(): void {\r\n        window.renderEngine.clearRect(window.tileMap.bounds);\r\n        window.tileMap.draw();\r\n\r\n        // TODO:\r\n        // Create abstraction into animated text rendering.\r\n        window.renderEngine.renderText(\r\n            window.levelManager.currentLevel.levelName,\r\n            64,\r\n            32,\r\n            'red',\r\n            32,\r\n            'impact'\r\n        );\r\n\r\n        window.enemySpawner.draw();\r\n        this.towerManager.draw();\r\n        window.projectileEngine.draw();\r\n        this.menu.draw();\r\n    }\r\n\r\n    static isOverMouseMenu(): boolean {\r\n        const menuBounds = GameScene.getElementBounds('tower_menu');\r\n        return menuBounds.containsRect(new Rectangle(window.mouseInfo.x, window.mouseInfo.y, 1, 1));\r\n    }\r\n\r\n    static isOverGameBounds(): boolean {\r\n        return window.tileMap.bounds.containsRect(\r\n            new Rectangle(window.mouseInfo.x, window.mouseInfo.y, 1, 1)\r\n        );\r\n    }\r\n\r\n    static getElementBounds(elementId: string): Rectangle {\r\n        const element = document.getElementById(elementId);\r\n        return new Rectangle(\r\n            element.clientLeft,\r\n            element.clientTop,\r\n            element.clientWidth,\r\n            element.clientHeight\r\n        );\r\n    }\r\n\r\n    mouseDown(): void {}\r\n\r\n    mouseUp(): void {\r\n        if (GameScene.isOverMouseMenu()) {\r\n            return;\r\n        }\r\n        if (!GameScene.isOverGameBounds()) {\r\n            return;\r\n        }\r\n\r\n        const x = Math.floor(window.mouseInfo.x / window.tileMap.tileWidth);\r\n        const y = Math.floor(\r\n            (window.mouseInfo.y - window.tileMap.tileHeight) / window.tileMap.tileHeight\r\n        );\r\n        const destinationTile = window.tileMap.tileMatrix[y][x];\r\n        this.menu.clearStagedTower();\r\n        this.towerManager.createTower(destinationTile);\r\n    }\r\n\r\n    mouseMove(x: number, y: number): void {}\r\n\r\n    resize(): void {}\r\n}\r\n","import { Rectangle } from '../DataObjects/rectangle';\r\nimport { SceneInterface } from './scene.interface';\r\nimport { Scenes } from './scenes.enum';\r\n\r\nexport class LoadScene implements SceneInterface {\r\n    private loadScreenRect: Rectangle;\r\n\r\n    private loadingText: string;\r\n\r\n    constructor() {\r\n        this.loadScreenRect = window.gameConfig.loadScreenRect;\r\n    }\r\n\r\n    init(): void {}\r\n\r\n    update(): void {\r\n        this.loadingText = `${window.assetManager.loadedAssetCount}/${window.assetManager.totalAssets}`;\r\n        window.assetManager.update();\r\n        if (window.assetManager.loadCompleted) {\r\n            window.sceneManager.toggleActiveScene(Scenes.game);\r\n        }\r\n    }\r\n\r\n    render(): void {\r\n        window.renderEngine.renderText(this.loadingText, 0, 0, 'blue', 30, 'impact');\r\n        window.renderEngine.renderRect(this.loadScreenRect, 'black', true);\r\n    }\r\n\r\n    mouseDown(): void {}\r\n\r\n    mouseUp(): void {}\r\n\r\n    mouseMove(x: number, y: number): void {}\r\n\r\n    resize(): void {}\r\n}\r\n","import { GameScene } from './gameScene';\r\nimport { LoadScene } from './loadScene';\r\nimport { SceneInterface } from './scene.interface';\r\nimport { Scenes } from './scenes.enum';\r\n\r\nexport class SceneManager {\r\n    private currentScene: SceneInterface;\r\n\r\n    private loadScene: LoadScene;\r\n\r\n    private gameScene: GameScene;\r\n\r\n    constructor() {\r\n        // TODO:\r\n        // Inject depependencies, no initialization\r\n        this.loadScene = new LoadScene();\r\n        this.gameScene = new GameScene();\r\n    }\r\n\r\n    public toggleActiveScene(newScene: Scenes): void {\r\n        if (newScene === Scenes.loading) {\r\n            this.currentScene = this.loadScene;\r\n        }\r\n\r\n        if (newScene === Scenes.game) {\r\n            this.currentScene = this.gameScene;\r\n        }\r\n\r\n        this.currentScene.init();\r\n    }\r\n\r\n    public update(): void {\r\n        if (this.currentScene) {\r\n            this.currentScene.update();\r\n        }\r\n    }\r\n\r\n    public render(): void {\r\n        if (this.currentScene) {\r\n            this.currentScene.render();\r\n        }\r\n    }\r\n}\r\n","export enum Scenes {\r\n    loading,\r\n    game\r\n}\r\n","import { ImageObject } from '../DataObjects/imageObject';\r\nimport { Rectangle } from '../DataObjects/rectangle';\r\n\r\nexport class Tile {\r\n    public bounds: Rectangle;\r\n\r\n    private imageObject: ImageObject;\r\n\r\n    private fontSize = 12;\r\n\r\n    constructor(bounds: Rectangle, imageObject: ImageObject) {\r\n        this.bounds = bounds;\r\n        this.imageObject = imageObject;\r\n    }\r\n\r\n    public draw(col: number, row: number): void {\r\n        window.renderEngine.renderImageSource(\r\n            this.imageObject.image,\r\n            this.imageObject.sourceRectangle,\r\n            this.imageObject.destinationRectangle\r\n        );\r\n\r\n        // this.gameScene.renderEngine.renderText(\r\n        //     col + '_' + row,\r\n        //     this.bounds.left,\r\n        //     this.bounds.top + this.fontSize,\r\n        //     'black',\r\n        //     this.fontSize,\r\n        //     'Calibri');\r\n    }\r\n}\r\n","import { ImageObject } from '../DataObjects/imageObject';\r\nimport { Rectangle } from '../DataObjects/rectangle';\r\nimport { Tile } from './tile';\r\n\r\nexport class TileMap {\r\n    public wayPoints: any = [];\r\n\r\n    public tileMatrix: Tile[][];\r\n\r\n    public rows = window.gameConfig.tileMapRows;\r\n\r\n    public cols = window.gameConfig.tileMapCols;\r\n\r\n    public tileWidth = window.gameConfig.tileMapTileWidth;\r\n\r\n    public tileHeight = window.gameConfig.tileMapTileHeight;\r\n\r\n    public bounds: Rectangle;\r\n\r\n    private tileImage: HTMLImageElement;\r\n\r\n    private waterTileImageObject: ImageObject;\r\n\r\n    private pathTileImageObject: ImageObject;\r\n\r\n    constructor(tileImage: HTMLImageElement) {\r\n        this.tileImage = tileImage;\r\n\r\n        this.initTileMatrix();\r\n        this.bounds = new Rectangle(0, 0, this.cols * this.tileWidth, this.rows * this.tileHeight);\r\n    }\r\n\r\n    private initTileMatrix(): void {\r\n        // TODO:\r\n        // Read matrix data from configurable file\r\n        const matrix = [\r\n            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n            [1, 1, 1, 0, 1, 1, 1, 0, 0, 0],\r\n            [0, 0, 1, 0, 1, 0, 1, 0, 0, 0],\r\n            [0, 0, 1, 1, 1, 0, 1, 0, 0, 0],\r\n            [0, 0, 0, 0, 0, 0, 1, 0, 0, 0],\r\n            [0, 0, 0, 0, 1, 1, 1, 0, 0, 0],\r\n            [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],\r\n            [0, 0, 0, 0, 1, 1, 0, 0, 0, 0],\r\n            [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]\r\n        ];\r\n\r\n        this.wayPoints = [\r\n            { x: 0, y: 0 },\r\n            { x: 0, y: 1 },\r\n            { x: 0, y: 2 },\r\n            { x: 1, y: 2 },\r\n            { x: 2, y: 2 },\r\n            { x: 2, y: 3 },\r\n            { x: 2, y: 4 },\r\n            { x: 3, y: 4 },\r\n            { x: 4, y: 4 },\r\n            { x: 4, y: 3 },\r\n            { x: 4, y: 2 },\r\n            { x: 5, y: 2 },\r\n            { x: 6, y: 2 },\r\n            { x: 6, y: 3 },\r\n            { x: 6, y: 4 },\r\n            { x: 6, y: 5 },\r\n            { x: 6, y: 6 },\r\n            { x: 5, y: 6 },\r\n            { x: 4, y: 6 },\r\n            { x: 4, y: 7 },\r\n            { x: 4, y: 8 },\r\n            { x: 5, y: 8 },\r\n            { x: 5, y: 9 },\r\n            { x: 6, y: 9 },\r\n            { x: 7, y: 9 },\r\n            { x: 8, y: 9 },\r\n            { x: 9, y: 9 }\r\n        ];\r\n\r\n        this.tileMatrix = [];\r\n        for (let row = 0; row < this.rows; row += 1) {\r\n            this.tileMatrix[row] = [];\r\n            for (let col = 0; col < this.cols; col += 1) {\r\n                const matrixValue = matrix[row][col];\r\n                const tileImageObject = this.getTileImageObject(\r\n                    matrixValue,\r\n                    this.tileWidth * col,\r\n                    this.tileHeight * row\r\n                );\r\n\r\n                // TODO:\r\n                // Tile should provide underlying imageObject with coordinates and size values.\r\n                // Abstract source rectangle values into \"tilesSpriteSheet\" configuration.\r\n                const tileBounds = new Rectangle(\r\n                    this.tileWidth * col,\r\n                    this.tileHeight * row,\r\n                    this.tileWidth,\r\n                    this.tileHeight\r\n                );\r\n                // console.log('col:' + col + ' row:' + row)\r\n                this.tileMatrix[row][col] = new Tile(tileBounds, tileImageObject);\r\n            }\r\n        }\r\n    }\r\n\r\n    private getTileImageObject(\r\n        matrixValue: number,\r\n        destinationX: number,\r\n        destinationY: number\r\n    ): ImageObject {\r\n        const tileImageObject = new ImageObject();\r\n        tileImageObject.image = this.tileImage;\r\n        tileImageObject.x = destinationX;\r\n        tileImageObject.y = destinationY;\r\n        tileImageObject.width = this.tileWidth;\r\n        tileImageObject.height = this.tileHeight;\r\n        tileImageObject.swidth = 32;\r\n        tileImageObject.sheight = 32;\r\n\r\n        if (matrixValue === 0) {\r\n            tileImageObject.sx = 0;\r\n            tileImageObject.sy = 0;\r\n        } else {\r\n            tileImageObject.sx = 32;\r\n            tileImageObject.sy = 0;\r\n        }\r\n\r\n        return tileImageObject;\r\n    }\r\n\r\n    public draw(): void {\r\n        for (let row = 0; row < this.rows; row += 1) {\r\n            for (let col = 0; col < this.cols; col += 1) {\r\n                this.tileMatrix[row][col].draw(col, row);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { Rectangle } from '../DataObjects/rectangle';\r\nimport { Vector2 } from '../DataObjects/vector2';\r\nimport { Enemy } from '../Enemies/enemy';\r\nimport { Tile } from '../Tiles/tile';\r\n\r\nexport abstract class BaseTower {\r\n    public shootRange = 20000;\r\n\r\n    public targetInRange: boolean;\r\n\r\n    public targetDirection: Vector2;\r\n\r\n    public destinationTile: Tile;\r\n\r\n    public target: Enemy;\r\n\r\n    public center: Vector2;\r\n\r\n    private rotation = 0;\r\n\r\n    private towerImage: HTMLImageElement;\r\n\r\n    private selected: boolean;\r\n\r\n    private southAngle = 180;\r\n\r\n    constructor(destinationTile: Tile, towerImage: HTMLImageElement) {\r\n        this.destinationTile = destinationTile;\r\n        this.towerImage = towerImage;\r\n\r\n        this.center = Vector2.empty;\r\n    }\r\n\r\n    public update(): void {\r\n        this.center.x = this.destinationTile.bounds.getCenterWidth;\r\n        this.center.y = this.destinationTile.bounds.getCenterHeight;\r\n        this.destinationTile.bounds.update();\r\n\r\n        this.updateTarget();\r\n        this.updateTargetInRange();\r\n        this.updateRotation();\r\n    }\r\n\r\n    public draw(): void {\r\n        this.drawRange();\r\n\r\n        // TODO:\r\n        // Implement animation class and call draw\r\n        // Animation class to handle source rect updates.\r\n        const sourceRectangle = new Rectangle(0, 0, 32, 32);\r\n\r\n        window.renderEngine.renderRotatedImageSource(\r\n            this.towerImage,\r\n            sourceRectangle,\r\n            this.destinationTile.bounds,\r\n            this.rotation\r\n        );\r\n\r\n        this.drawSelection();\r\n\r\n        window.renderEngine.renderText(\r\n            `hasTarget: ${this.target ? 'yes' : 'no'}`,\r\n            64,\r\n            64,\r\n            'red',\r\n            32,\r\n            'impact'\r\n        );\r\n\r\n        window.renderEngine.renderText(`rotation: ${this.rotation}`, 64, 96, 'red', 32, 'impact');\r\n    }\r\n\r\n    public setSelection(selected: boolean): void {\r\n        this.selected = selected;\r\n    }\r\n\r\n    private drawRange(): void {\r\n        window.renderEngine.renderEllipse(\r\n            this.center.x,\r\n            this.center.y,\r\n            'red',\r\n            0.5,\r\n            this.shootRange,\r\n            false\r\n        );\r\n    }\r\n\r\n    private drawSelection(): void {\r\n        // TODO:\r\n        // Draw any overlay selection effects\r\n    }\r\n\r\n    private updateTargetInRange(): void {\r\n        if (this.target != null && this.target.active) {\r\n            this.targetDirection = this.center.subtract(this.target.center);\r\n            const distance = this.targetDirection.magnitude();\r\n            if (distance <= this.shootRange) {\r\n                this.targetInRange = true;\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.targetInRange = false;\r\n    }\r\n\r\n    private updateRotation(): void {\r\n        // Rotate the tower towards it's current target or\r\n        // rotate to default position if no target exist or if target not in range.\r\n\r\n        // Apperantly rotaion can be negative value. e.g. -100\r\n        // This depends on which direction the tower moves\r\n        // e.g. start at 0 move clockwise results in positive value 0 to 360\r\n        // e.g. start at 0 move counter clockwise results in negative value 0 to -360\r\n\r\n        // The rotation value can also get greater than 360 of smaller that -360\r\n        // thus we have to stop and reset rotation at these points\r\n\r\n        if (!this.target) {\r\n            //this.calculateRotation(new Vector2(0, -1));\r\n            if (this.rotation < -180 && this.rotation > -360) {\r\n                // Reset rotation by moving tower counter clockwise\r\n                this.rotation -= 1.5;\r\n            } else if (this.rotation > -180 && this.rotation < 0) {\r\n                // Reset rotation by moving tower clockwise\r\n                this.rotation += 1.5;\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (this.targetInRange) {\r\n            this.calculateRotation(\r\n                new Vector2(\r\n                    this.target.center.x - this.center.x,\r\n                    this.target.center.y - this.center.y\r\n                )\r\n            );\r\n        }\r\n    }\r\n\r\n    private calculateRotation(distance: Vector2): void {\r\n        this.rotation = Math.atan2(distance.y, distance.x) * (180 / Math.PI) - 180;\r\n    }\r\n\r\n    private updateTarget(): void {\r\n        let distance = 0;\r\n        let closestDistance = 99999;\r\n        let closestEnemy: Enemy;\r\n\r\n        const livingEnemies = window.enemySpawner.enemies.filter(e => e.active);\r\n        for (let e = 0; e < livingEnemies.length; e += 1) {\r\n            const enemy = livingEnemies[e];\r\n            distance = enemy.center.distance(this.center);\r\n\r\n            if (distance < closestDistance || closestEnemy == null) {\r\n                closestDistance = distance;\r\n                closestEnemy = enemy;\r\n            }\r\n        }\r\n\r\n        this.target = closestEnemy;\r\n    }\r\n}\r\n","import { Vector2 } from '../DataObjects/vector2';\r\nimport { Tile } from '../Tiles/tile';\r\nimport { BaseTower } from './baseTower';\r\n\r\nexport class PlainTower extends BaseTower {\r\n    private plainTowerShootSpeed = window.gameConfig.plainTowerShootSpeed;\r\n\r\n    private plainTowerShootRate = window.gameConfig.plainTowerShootRate;\r\n\r\n    private shootElapsed = 0;\r\n\r\n    private accuracyEnabled = true;\r\n\r\n    constructor(destinationTile: Tile, towerImage: HTMLImageElement) {\r\n        super(destinationTile, towerImage);\r\n        super.shootRange = window.gameConfig.plainTowerShootRange;\r\n    }\r\n\r\n    public update(): void {\r\n        super.update();\r\n\r\n        this.updateShoot();\r\n    }\r\n\r\n    private updateShoot(): void {\r\n        const { delta } = window.gameTime;\r\n        this.shootElapsed += delta;\r\n        if (this.targetInRange && this.shootElapsed >= this.plainTowerShootRate) {\r\n            this.shootElapsed = 0;\r\n            let direction = Vector2.empty;\r\n\r\n            if (this.accuracyEnabled) {\r\n                direction = this.target.futurePosition.subtract(this.center);\r\n            } else {\r\n                direction = this.target.center.subtract(this.center);\r\n            }\r\n\r\n            const normalizedDirection = direction.normalize();\r\n            window.projectileEngine.activateProjectile(\r\n                this.center,\r\n                normalizedDirection,\r\n                this.plainTowerShootSpeed\r\n            );\r\n        }\r\n    }\r\n\r\n    public draw(): void {\r\n        super.draw();\r\n    }\r\n}\r\n","import { Tile } from '../Tiles/tile';\r\nimport { BaseTower } from './baseTower';\r\nimport { PlainTower } from './plainTower';\r\n\r\nexport class TowerManager {\r\n    public towers: BaseTower[] = [];\r\n\r\n    private towerImage: HTMLImageElement;\r\n\r\n    constructor() {\r\n        this.towerImage = window.assetManager.getImage('towerplain');\r\n    }\r\n\r\n    public update(): void {\r\n        this.towers.forEach(tower => {\r\n            tower.update();\r\n        });\r\n    }\r\n\r\n    public draw(): void {\r\n        this.towers.forEach(tower => {\r\n            tower.draw();\r\n        });\r\n    }\r\n\r\n    public createTower(destinationTile: Tile): void {\r\n        const tileEmpty =\r\n            this.towers.filter(\r\n                t =>\r\n                    t.destinationTile.bounds.left === destinationTile.bounds.left &&\r\n                    t.destinationTile.bounds.top === destinationTile.bounds.top\r\n            ).length === 0;\r\n\r\n        if (tileEmpty) {\r\n            this.towers.push(new PlainTower(destinationTile, this.towerImage));\r\n            console.log(\r\n                `tileX:${destinationTile.bounds.left} tileY:${destinationTile.bounds.top} destTile:${destinationTile.bounds}`\r\n            );\r\n        }\r\n    }\r\n}\r\n","import { Rectangle } from './DataObjects/rectangle';\r\nimport { Vector2 } from './DataObjects/vector2';\r\n\r\nexport class GameConfig {\r\n    public canvasWidth = 480;\r\n\r\n    public canvasHeight = 480;\r\n\r\n    public backgroundBounds = new Rectangle(0, 0, this.canvasWidth, this.canvasHeight);\r\n\r\n    public loadScreenRect = new Rectangle(0, 0, this.canvasWidth, this.canvasHeight);\r\n\r\n    public tileMapRows = 10;\r\n\r\n    public tileMapCols = 10;\r\n\r\n    public tileMapTileWidth = 48;\r\n\r\n    public tileMapTileHeight = 48;\r\n\r\n    public plainTowerShootSpeed = 250;\r\n\r\n    public plainTowerShootRate = 0.7;\r\n\r\n    public plainTowerShootRange = 150;\r\n\r\n    public enemyFuturePositionModifier = 20;\r\n\r\n    public menuStagedTowerImageWidth = 48;\r\n\r\n    public menuStagedTowerImageHeight = 48;\r\n\r\n    public enemySize = new Vector2(48, 48);\r\n}\r\n","import { Rectangle } from './DataObjects/rectangle';\r\n\r\nexport class RenderEngine {\r\n    private context: CanvasRenderingContext2D;\r\n\r\n    constructor() {\r\n        const gameCanvas = document.getElementById('game-canvas') as HTMLCanvasElement;\r\n        this.context = gameCanvas.getContext('2d');\r\n    }\r\n\r\n    public clearRect(rect: Rectangle): void {\r\n        if (rect) {\r\n            this.context.clearRect(rect.left, rect.top, rect.width, rect.height);\r\n        }\r\n    }\r\n\r\n    public renderRect(rect: Rectangle, color: string, fill: boolean): void {\r\n        const originalFillStyle = this.context.fillStyle;\r\n        const originalStrokeStyle = this.context.strokeStyle;\r\n\r\n        if (fill) {\r\n            this.context.fillStyle = color;\r\n            this.context.fillRect(rect.left, rect.top, rect.width, rect.height);\r\n        } else {\r\n            this.context.beginPath();\r\n            this.context.strokeStyle = color;\r\n            this.context.strokeRect(rect.left, rect.top, rect.width, rect.height);\r\n        }\r\n\r\n        this.context.fillStyle = originalFillStyle;\r\n        this.context.strokeStyle = originalStrokeStyle;\r\n    }\r\n\r\n    public renderText(\r\n        text: string,\r\n        x: number,\r\n        y: number,\r\n        color: string,\r\n        fontSize: number,\r\n        fontFamily: string\r\n    ): void {\r\n        this.context.fillStyle = color;\r\n        this.context.font = `${fontSize}px ${fontFamily}`;\r\n        this.context.fillText(text, x, y);\r\n    }\r\n\r\n    public renderImageRect(image: HTMLImageElement, bounds: Rectangle): void {\r\n        this.renderImage(image, bounds.left, bounds.top, bounds.width, bounds.height);\r\n    }\r\n\r\n    public renderImage(\r\n        image: HTMLImageElement,\r\n        x: number,\r\n        y: number,\r\n        width: number = null,\r\n        height: number = null\r\n    ): void {\r\n        const w = width == null ? image.width : width;\r\n        const h = height == null ? image.height : height;\r\n        this.context.drawImage(image, x, y, w, h);\r\n    }\r\n\r\n    public renderImageSource(\r\n        image: HTMLImageElement,\r\n        sourceRect: Rectangle,\r\n        destRect: Rectangle\r\n    ): void {\r\n        if (\r\n            sourceRect.left < 0 ||\r\n            sourceRect.top < 0 ||\r\n            sourceRect.height <= 0 ||\r\n            sourceRect.height <= 0\r\n        ) {\r\n            return;\r\n        }\r\n        this.context.drawImage(\r\n            image,\r\n            sourceRect.left,\r\n            sourceRect.top,\r\n            sourceRect.width,\r\n            sourceRect.height,\r\n            destRect.left,\r\n            destRect.top,\r\n            destRect.width,\r\n            destRect.height\r\n        );\r\n    }\r\n\r\n    public renderRotatedImageSource(\r\n        image: HTMLImageElement,\r\n        sourceRect: Rectangle,\r\n        destRect: Rectangle,\r\n        rotation = 0\r\n    ): void {\r\n        this.context.save();\r\n        this.context.translate(destRect.getCenterWidth, destRect.getCenterHeight);\r\n        this.context.rotate((rotation - 90) * (Math.PI / 180));\r\n\r\n        const rotatedDestRect = new Rectangle(\r\n            -(destRect.width / 2),\r\n            -(destRect.height / 2),\r\n            destRect.width,\r\n            destRect.height\r\n        );\r\n\r\n        this.renderImageSource(image, sourceRect, rotatedDestRect);\r\n\r\n        this.context.restore();\r\n    }\r\n\r\n    public renderEllipse(\r\n        centerX: number,\r\n        centerY: number,\r\n        color: string,\r\n        opacity: number,\r\n        radius: number,\r\n        fill: boolean\r\n    ): void {\r\n        this.context.save();\r\n        this.context.globalAlpha = opacity;\r\n        this.context.strokeStyle = color;\r\n        this.context.beginPath();\r\n        this.context.ellipse(centerX, centerY, radius, radius, Math.PI / 4, 0, 2 * Math.PI);\r\n\r\n        if (fill) {\r\n            this.context.fill();\r\n        } else {\r\n            this.context.stroke();\r\n        }\r\n        this.context.restore();\r\n    }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { AssetManager } from './AssetLoading/assetManager';\r\nimport { GameTime } from './DataObjects/gameTime';\r\nimport { GameConfig } from './gameConfig';\r\nimport { RenderEngine } from './renderEngine';\r\nimport { SceneInterface } from './Scenes/scene.interface';\r\nimport { SceneManager } from './Scenes/sceneManager';\r\nimport { Scenes } from './Scenes/scenes.enum';\r\n\r\nexport class Game {\r\n    public assetManager: AssetManager;\r\n\r\n    public currentScene: SceneInterface;\r\n\r\n    private running: boolean;\r\n\r\n    constructor() {\r\n        window.gameConfig = new GameConfig();\r\n        window.renderEngine = new RenderEngine();\r\n        window.assetManager = new AssetManager();\r\n        window.assetManager.init();\r\n        window.sceneManager = new SceneManager();\r\n        window.sceneManager.toggleActiveScene(Scenes.loading);\r\n        window.gameTime = new GameTime();\r\n\r\n        window.addEventListener('mousemove', e => {\r\n            Game.mouseMove(e);\r\n        });\r\n    }\r\n\r\n    public start(): void {\r\n        if (this.running) {\r\n            return;\r\n        }\r\n\r\n        this.running = true;\r\n        this.loop();\r\n    }\r\n\r\n    private loop(): void {\r\n        window.gameTime.update();\r\n\r\n        if (window.sceneManager) {\r\n            window.sceneManager.update();\r\n            window.sceneManager.render();\r\n        }\r\n\r\n        requestAnimationFrame(() => this.loop());\r\n    }\r\n\r\n    static mouseMove(event: any): void {\r\n        window.mouseInfo = { x: event.x, y: event.y };\r\n    }\r\n}\r\n\r\nwindow.addEventListener('load', () => {\r\n    const game = new Game();\r\n    game.start();\r\n});\r\n"],"names":["images","levelInfo","init","this","levelInfoLoaded","loadCompleted","totalAssets","initAssets","request","XMLHttpRequest","onload","status","data","JSON","parse","responseText","assetCount","initImages","imageAssets","initLevelInfo","levelInfoFile","open","send","forEach","asset","image","ImageAsset","key","src","push","img","console","error","update","loadedAssetCount","filter","x","loaded","length","getImage","at","constructor","Image","delta","previousLoopTime","Date","now","currentTime","sourceRect","destinationRect","sourceRectangle","Rectangle","sx","sy","swidth","sheight","destinationRectangle","y","width","height","left","top","updateRight","right","updateBottom","bottom","intersectRect","rectangle","containsRect","getCenterWidth","getCenterHeight","clone","equals","rect","toString","Vector2","subtract","vector2","distance","Math","sqrt","magnitude","normalize","normalX","normalY","Number","isNaN","empty","enemyImage","wayPointReachedThreshold","moveSpeed","hp","maxHp","topPadding","hpRemainingBarColor","hpFullBarColor","alive","originalWayPoints","window","tileMap","wayPoints","reset","active","movementWayPoints","slice","movements","up","down","position","futurePosition","size","gameConfig","enemySize","center","velocity","bounds","nextMovePoint","hpBounds","liveBounds","enemyName","random","onLastWaypoint","firstWayPoint","shift","waypointBounds","tileMatrix","updateBounds","updateHpBounds","direction","distanceFromNextWaypoint","nextWaypointReached","dispatchEvent","CustomEvent","nextWayPoint","normalizedDirection","setMoveDirection","applyVelocity","updateLifeBounds","enemyFuturePositionModifier","percentageDiff","percentageLive","draw","renderEngine","renderImageSource","drawRemainingHPBar","drawFullHPBar","renderRect","hit","enemies","enemySpawnCount","enemySpawnElapsed","enemiesKilled","enemiesEscaped","assetManager","setCurrentLevel","addEventListener","enemy","updateSpawner","updateRoundCheck","enemySpawnCountMax","enemySpawnRate","createEnemy","levelManager","currentLevel","nextLevel","Enemy","enemyMoveSpeed","enemyMaxHp","loadLevel","index","levelIndex","l","stagedTowerImageWidth","menuStagedTowerImageWidth","stagedTowerImageHeight","menuStagedTowerImageHeight","towerClicked","menuHeight","document","getElementById","clientHeight","imageDictionary","clearStagedTower","stagedTower","type","mouseInfo","tX","tY","find","renderImage","projectileImage","ttl","ttlMax","worldBounds","projectileColor","imageSourceRect","updateTTL","updateVelocity","startPosition","projectiles","projectile","activateProjectile","poolSufficient","i","expandProjectilePool","Projectile","GameScene","collisionCheckElapsed","backgroundImage","tileImage","LevelManager","menu","Menu","TileMap","enemySpawner","EnemySpawner","towerManager","TowerManager","projectileEngine","ProjectileEngine","createTower","e","mouseMove","mouseDown","mouseUp","gameTime","checkProjectileEnemyCollision","render","clearRect","renderText","levelName","static","getElementBounds","elementId","element","clientLeft","clientTop","clientWidth","isOverMouseMenu","isOverGameBounds","floor","tileWidth","tileHeight","destinationTile","resize","loadScreenRect","loadingText","sceneManager","toggleActiveScene","Scenes","game","loadScene","LoadScene","gameScene","newScene","loading","currentScene","imageObject","fontSize","col","row","rows","tileMapRows","cols","tileMapCols","tileMapTileWidth","tileMapTileHeight","initTileMatrix","matrix","matrixValue","tileImageObject","getTileImageObject","tileBounds","Tile","destinationX","destinationY","ImageObject","towerImage","shootRange","rotation","southAngle","updateTarget","updateTargetInRange","updateRotation","drawRange","renderRotatedImageSource","drawSelection","target","setSelection","selected","renderEllipse","targetDirection","targetInRange","calculateRotation","atan2","PI","closestEnemy","closestDistance","livingEnemies","PlainTower","BaseTower","super","plainTowerShootSpeed","plainTowerShootRate","shootElapsed","accuracyEnabled","plainTowerShootRange","updateShoot","towers","tower","t","log","canvasWidth","canvasHeight","backgroundBounds","gameCanvas","context","getContext","color","fill","originalFillStyle","fillStyle","originalStrokeStyle","strokeStyle","fillRect","beginPath","strokeRect","text","fontFamily","font","fillText","renderImageRect","w","h","drawImage","destRect","save","translate","rotate","rotatedDestRect","restore","centerX","centerY","opacity","radius","globalAlpha","ellipse","stroke","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","Game","GameConfig","RenderEngine","AssetManager","SceneManager","GameTime","start","running","loop","requestAnimationFrame","event"],"sourceRoot":""}